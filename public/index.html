<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI 채팅</title>
<style>
body { font-family: sans-serif; margin:0; display:flex; flex-direction:column; height:100vh; background:#f5f5f5; }
#chat { flex:1; overflow-y:auto; padding:10px; }
#inputArea { display:flex; padding:10px; background:#fff; }
#message { flex:1; padding:8px; border:1px solid #ccc; border-radius:5px; }
#sendBtn { margin-left:10px; padding:8px 12px; border:none; background:#007bff; color:white; border-radius:5px; cursor:pointer; }
.user { text-align:right; color:#007bff; margin:5px 0; }
.bot { text-align:left; color:#333; margin:5px 0; }
</style>
</head>
<body>
<div id="chat"></div>
<div id="inputArea">
    <input id="message" type="text" placeholder="메시지를 입력하세요...">
    <button id="sendBtn">전송</button>
</div>
<script>
const chatDiv = document.getElementById("chat");
const messageInput = document.getElementById("message");
const sendBtn = document.getElementById("sendBtn");

function appendMessage(text, sender) {
    const div = document.createElement("div");
    div.className = sender;
    div.textContent = text;
    chatDiv.appendChild(div);
    chatDiv.scrollTop = chatDiv.scrollHeight;
}

async function sendMessage() {
    const msg = messageInput.value.trim();
    if (!msg) return;
    appendMessage(msg, "user");
    messageInput.value = "";

    try {
        const res = await fetch("/chat", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message: msg }),
        });
        const data = await res.json();
        appendMessage(data.reply || "응답 없음", "bot");
    } catch (e) {
        appendMessage("서버 오류 발생", "bot");
    }
}

sendBtn.addEventListener("click", sendMessage);
messageInput.addEventListener("keypress", e => { if(e.key==="Enter") sendMessage(); });
</script>
</body>
</html>
